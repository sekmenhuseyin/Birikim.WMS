@{
    ViewBag.Title = "Kat Kartı işlemleri";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h3 class="page-title">Kat İşlemleri</h3>
<div class="row">
    <div class="col-md-12">
        <div id="CreateEdit"></div>
        <div>
            <div class="portlet box green">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-gift"></i>Kat Listesi
                    </div>
                </div>
                <div class="portlet-body form">
                    <div class="form-horizontal">
                        <div class="form-body">
                            <div class="row">
                                <div class="col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                    <div class="form-group">
                                        <div class="radio-list col-xs-12 col-md-12 col-lg-12">
                                            <div class="col-sm-12 col-xs-12">
                                                <label>
                                                    <label style="color:#32c5d2;">Durum</label>
                                                </label>
                                            </div>
                                            <div class="radio-list col-sm-12 col-xs-12">
                                                <label class="radio-inline col-xs-3 col-md-3 col-lg-3" style="padding-left:20px;">
                                                    <input type="radio" name="Locked" value="Locked" /> Aktif
                                                </label>
                                                <label class="radio-inline col-xs-3 col-md-3 col-lg-3">
                                                    <input type="radio" name="Locked" value="noLocked" checked /> Pasif
                                                </label>
                                                <label class="radio-inline col-xs-3 col-md-3 col-lg-3">
                                                    <input type="radio" name="Locked" value="All" checked /> Tümü
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-6 col-md-6 col-lg-7">
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                        <div class="row">
                                            <label class="control-label col-sm-2 col-md-2 col-lg-2" style="color:#32c5d2;">Depo</label>
                                            <div class="col-sm-8 col-md-8 col-lg-7">
                                                <select id="StoreListi" class="form-control"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="margin-top:5px;">
                                        <div class="row">
                                            <label class="control-label col-sm-2 col-md-2 col-lg-2" style="color:#32c5d2;">Koridor</label>
                                            <div class="col-sm-8 col-md-8 col-lg-7">
                                                <select id="CorridorList" class="form-control"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="margin-top:5px;">
                                        <div class="row">
                                            <label class="control-label col-xs-2 col-sm-2 col-md-2 col-lg-2" style="color:#32c5d2;">Raf</label>
                                            <div class="col-sm-8 col-md-8 col-lg-7">
                                                <select id="ShelfListi" class="form-control"></select>
                                            </div>
                                            <div class="col-sm-2 col-md-2 col-lg-2">
                                                <button type="submit" class="btn green ara-btn" id="SearchBtn">Ara</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive" id="FloorGrid" style="padding:10px;margin-top:18px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/Content/Scripts/_Operation.js"></script>
<script type="text/javascript">
    var FloorGridUrl = '@Url.Action("FloorGridPartial", "Floor")';
    var FloorDetailUrl = '@Url.Action("FloorDetailPartial", "Floor")';
    var DeleteFunctionUrl = '@Url.Action("Delete", "Floor")';
    var CorrridorList = '@Url.Action("SearchCorrridor", "Shelf")';
    var StoreListUrl = '@Url.Action("StoreList", "Corridor")';
    var ShelfListUrl = '@Url.Action("ShelfList", "Chapter")';
    var ChapterListUrl = '@Url.Action("ChapterList", "Floor")';
    $(document).ready(function () {
        PartialView(FloorDetailUrl, 'CreateEdit', JSON.stringify({ Id: '0' }));
        StoreList();
        $('#CorridorList').prop('disabled', 'disabled');
        $('#ShelfListi').prop('disabled', 'disabled');
        $('#ChapterListi').prop('disabled', 'disabled');

        $('#SearchBtn').click(function () {
            FuncSearchBtn();
        });

        $('#StoreListi').on('change', function () {
            if (this.value == 0) {
                $("#CorridorList option").remove();
                $('#CorridorList').prop('disabled', 'disabled');
                $("#ShelfListi option").remove();
                $('#ShelfListi').prop('disabled', 'disabled');
                $("#ChapterListi option").remove();
                $('#ChapterListi').prop('disabled', 'disabled');
            }
            else {
                $("#ShelfListi option").remove();
                $('#ShelfListi').prop('disabled', 'disabled');
                $("#ChapterListi option").remove();
                $('#ChapterListi').prop('disabled', 'disabled');
                CorridorList(this.value);
            }
        });
        $('#CorridorList').on('change', function () {
            if (this.value == 0) {
                $("#ShelfListi option").remove();
                $('#ShelfListi').prop('disabled', 'disabled');
                $("#ChapterListi option").remove();
                $('#ChapterListi').prop('disabled', 'disabled');
            }
            else {
                $("#ChapterListi option").remove();
                $('#ChapterListi').prop('disabled', 'disabled');
                Shelf(this.value);
            }
        });
        $('#ShelfListi').on('change', function () {
            if (this.value == 0) {
                $("#ChapterListi option").remove();
                $('#ChapterListi').prop('disabled', 'disabled');
            }
            else {
                Chapter(this.value);
            }
        });
    });
    function FuncSearchBtn() {
        var Type = $("input[type='radio'][name='Locked']:checked").val();
        var StoreId = $("#StoreListi option:selected").val();
        var CorridorId = $("#CorridorList option:selected").val();
        var ShelfId = $("#ShelfListi option:selected").val();
        var ChapterId = $("#ChapterListi option:selected").val();
        PartialView(FloorGridUrl, 'FloorGrid', JSON.stringify({ Id: (Type + "#" + StoreId + "#" + CorridorId + "#" + ShelfId) }));
    }
    function CorridorList(Id) {
        $("#CorridorList option").remove();

        $.ajax({
            url: CorrridorList,
            type: 'POST',
            data: JSON.stringify({ Id: Id }),
            dataType: "json",
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data != "") {
                    $("#CorridorList").removeAttr("disabled");
                    $("#CorridorList").append("<option value=" + '0' + ">Lütfen Karidor Seçiniz !!!</option>");
                    $.each(data, function (i, item) {
                        $("#CorridorList").append("<option value=" + item.ID + ">" + item.Koridor + "</option>");
                    });
                }
            }
        });
    }


    function CreateCorridorList(Id) {
        $("#CorridorList option").remove();
        $("#CorridorList").append("<option value=" + '0' + ">Lütfen Karidor Seçiniz !!!</option>");
        $.ajax({
            url: CorrridorList,
            type: 'POST',
            data: JSON.stringify({ Id: Id }),
            dataType: "json",
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data != "") {
                    $.each(data, function (i, item) {
                        $("#CorridorList").append("<option value=" + item.ID + ">" + item.Koridor + "</option>");
                    });
                }
            }
        });
    }
    function StoreList() {
        $("#StoreListi option").remove();
        $("#StoreListi").append("<option value=" + '0' + ">Lütfen Depo Seçiniz !!!</option>");
        $.ajax({
            url: StoreListUrl,
            type: 'POST',
            data: '',
            dataType: "json",
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data != "") {
                    $.each(data, function (i, item) {
                        $("#StoreListi").append("<option value=" + item.ID + ">" + item.DepoAdi + "</option>");
                    });
                }
            }
        });
    }
    function Shelf(Id) {
        $("#ShelfListi option").remove();
        $.ajax({
            url: ShelfListUrl,
            type: 'POST',
            data: JSON.stringify({ Id: Id }),
            dataType: "json",
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data != "") {
                    $("#ShelfListi").append("<option value=" + '0' + ">Lütfen Raf Seçiniz !!!</option>");
                    $("#ShelfListi").removeAttr("disabled");
                    $.each(data, function (i, item) {
                        $("#ShelfListi").append("<option value=" + item.ID + ">" + item.Raf + "</option>");
                    });
                }
            }
        });
    }
    function Chapter(Id) {
        $("#ChapterListi option").remove();
        $.ajax({
            url: ChapterListUrl,
            type: 'POST',
            data: JSON.stringify({ Id: Id }),
            dataType: "json",
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data != "") {
                    $("#ChapterListi").removeAttr("disabled");
                    $("#ChapterListi").append("<option value=" + '0' + ">Lütfen Bölüm Seçiniz !!!</option>");
                    $.each(data, function (i, item) {
                        $("#ChapterListi").append("<option value=" + item.Value + ">" + item.Text + "</option>");
                    });
                }
            }
        });
    }
    function FloorReturn(Data) {
        Modaldialog(Data.Message, (Data.Status == true ? "Başaralı" : "Hata"), "Tamam", "btn-success");
        CreateEdit('0');

    }
    function CreateEdit(Id) {
        PartialView(FloorDetailUrl, 'CreateEdit', JSON.stringify({ Id: Id == null ? '' : Id }));
    }
    function InsertRefresh() {
        PartialView(FloorDetailUrl, "CreateEdit", '0');
    }
</script>
