@model List<RaporCHKSelect>
@{
    ViewBag.Title = "Toplam Risk Analiz Raporu";
    Layout = "~/Views/Shared/_Layout.cshtml";
}@section Styles{
    <style>
        td.details-control {
            background: url('/Content/assets/global/plugins/datatables/images/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        tr.shown td.details-control {
            background: url('/Content/assets/global/plugins/datatables/images/details_close.png') no-repeat center center;
        }

        .btn {
            width: 120px;
            text-align: center;
        }

        .detay:hover {
            background-color: rgb(176, 190, 217) !important;
        }
    </style>
}
<div class="row control-content">
    <div class="col-sm-4 col-xs-12" style="margin-top:10px;">
        <div class="col-sm-4 col-xs-6" style="color:#32c5d2;font-weight:bold;">Başlangıç Hesap Kodu</div>
        <div class="col-sm-8 col-xs-6"><div class="basChk" style="width:100%;"></div></div>
    </div>
    <div class="col-sm-4 col-xs-12" style="margin-top:10px;">
        <div class="col-sm-4 col-xs-6" style="color:#32c5d2;font-weight:bold;">Bitiş Hesap Kodu</div>
        <div class="col-sm-8 col-xs-6"><div class="basChk" style="width:100%;"></div></div>
    </div>
    <div class="col-sm-3 col-xs-12" style="margin-top:10px;">
        <div class="col-sm-10 col-xs-4">
            <div class="btn btn-lg green listele-buton" style="width:100%; margin-bottom:10px;">Listele<i class="fa fa-check"></i></div>
        </div>
    </div>
</div>
<div class="row" id="toplam-riskbakiye-analizi-grid" style="margin-top:10px;"></div>
@section Scripts{
    <script src="~/Content/assets/global/plugins/moment/moment.min.js"></script>
    <script>
        var model = @Html.Raw(Json.Encode(Model));
        var basChk = "@ViewBag.BasChk";
        var bitChk = "@ViewBag.BitChk";
        var tempbasChk = "@ViewBag.BasChk";
        var tempbitChk = "@ViewBag.BitChk";
        $(document).ready(function () {
            $(".basChk").dxLookup({
                dataSource: model,
                searchEnabled: true,
                pageLoadMode: "nextButton",
                searchExpr: ["HesapKodu", "Unvan"],
                valueExpr: 'HesapKodu',
                displayExpr: 'Unvan',
                onValueChanged: function (e) {
                    tempbasChk = e.value;
                },
                itemTemplate: function (itemData, itemIndex, itemElement) {
                    itemElement.css({ "text-align": "left", "border-bottom": "1px solid #2fc1d8" });
                    if (itemIndex > 0) {
                        itemElement.css({ "margin-top": "-40px" });
                    }
                    var rightBlock = $("<div style=' margin: 2px; width:100%;'>");
                    rightBlock.append("<div><p style='font-size:11px; font-weight:bold; line-height: 0%;'><b>" + itemData.Unvan + "</b></p>");
                    rightBlock.append("<p style='line-height: 0%;font-size:11px;'>HesapKodu: <i>" + itemData.HesapKodu + "</i></p></div>");
                    itemElement.append(rightBlock);
                }
            });
            $(".bitChk").dxLookup({
                dataSource: model,
                searchEnabled: true,
                pageLoadMode: "nextButton",
                searchExpr: ["HesapKodu", "Unvan"],
                valueExpr: 'HesapKodu',
                displayExpr: 'Unvan',
                onValueChanged: function (e) {
                    tempbitChk = e.value;
                },
                itemTemplate: function (itemData, itemIndex, itemElement) {
                    itemElement.css({ "text-align": "left", "border-bottom": "1px solid #2fc1d8" });
                    if (itemIndex > 0) {
                        itemElement.css({ "margin-top": "-40px" });
                    }
                    var rightBlock = $("<div style=' margin: 2px; width:100%;'>");
                    rightBlock.append("<div><p style='font-size:11px; font-weight:bold; line-height: 0%;'><b>" + itemData.Unvan + "</b></p>");
                    rightBlock.append("<p style='line-height: 0%;font-size:11px;'>HesapKodu: <i>" + itemData.HesapKodu + "</i></p></div>");
                    itemElement.append(rightBlock);
                }
            });
      
        });
        $(document).on("click", ".listele-buton", function () {
            basChk = tempbasChk;
            bitChk = tempbitChk;
            PartialView("/Reports/Financial/RiskAnalizList", 'toplam-riskbakiye-analizi-grid', JSON.stringify({ baschk: basChk, bitchk: bitChk }));
        });
    </script>
}












