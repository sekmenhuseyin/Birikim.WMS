@model List<RaporGetKod>
@{
    ViewBag.Title = "Stok";
    Layout = "~/Views/Shared/_Layout.cshtml";
}@section Styles{<style>
    .dx-datagrid-headers .dx-row {
        color: white;
        border-bottom: 1px solid #D2D2D2;
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#32c5d2), color-stop(50%,#2989d8), color-stop(51%,#207cca), color-stop(100%,#7db9e8)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top, #32c5d2 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top, #32c5d2 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top, #32c5d2 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* IE10+ */
        background: linear-gradient(to bottom, #32c5d2 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* W3C */
    }
    .dx-datagrid .dx-column-indicators .dx-sort.dx-header-filter:after, .dx-datagrid .dx-column-indicators .dx-header-filter.dx-header-filter:before {color: white;}
    .btn {width: 120px;text-align: center;}
</style>
}<div class="row">
    <div class="control-content col-lg-11 col-md-12 col-sm-8">
        <div class="col-xs-12 col-sm-12 col-lg-5">
            <table>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Tarih</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="tarih" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"></td>
                </tr>
                <tr style="height:10px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><span></span></td>
                    <td style="width:160px;"><div style="width:200px;text-align:center;color:#32c5d2;font-weight:bold;">Başlangıç</div></td>
                    <td style="width:160px;"><div style="width:200px;text-align:center;color:#32c5d2;font-weight:bold;">Bitiş</div></td>
                </tr>
                <tr style="height:10px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Grup Kodu</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="grup-bas-select" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"><div class="grup-bit-select" style="float:left;width:90%;"></div></td>
                </tr>
                <tr style="height:5px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Tip Kodu</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="tip-bas-select" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"><div class="tip-bit-select" style="float:left;width:90%;"></div></td>
                </tr>
                <tr style="height:5px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Özel Kod</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="ozel-bas-select" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"><div class="ozel-bit-select" style="float:left;width:90%;"></div></td>
                </tr>
            </table>
        </div>
        <div class="col-lg-1 col-sm-12  col-xs-12"></div>
        <div class="col-xs-12 col-sm-12 col-lg-5">
            <table>
                <tr style="padding:8px; height:36px;">
                    <td style="width:120px;"></td>
                    <td style="width:160px;"></td>
                    <td style="width:160px;text-align:center;"></td>
                </tr>
                <tr style="height:10px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"></td>
                    <td style="width:160px;"><div style="width:200px;text-align:center;color:#32c5d2;font-weight:bold;">Başlangıç</div></td>
                    <td style="width:160px;"><div style="width:200px;text-align:center;color:#32c5d2;font-weight:bold;">Bitiş</div></td>
                </tr>
                <tr style="height:10px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Kod1</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="kod1-bas-select" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"><div class="kod1-bit-select" style="float:left;width:90%;"></div></td>
                </tr>
                <tr style="height:5px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Kod2</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="kod2-bas-select" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"><div class="kod2-bit-select" style="float:left;width:90%;"></div></td>
                </tr>
                <tr style="height:5px"><td colspan="6"></td></tr>
                <tr style="padding:8px;">
                    <td style="width:120px;"><div style="width:90%;float:left;color:#32c5d2;font-weight:bold;">Kod3</div><div style="width:10%;float:left;right:0;color:#32c5d2;font-weight:bold;">:</div></td>
                    <td style="width:160px;"><div class="kod3-bas-select" style="float:left;width:90%;"></div></td>
                    <td style="width:160px;"><div class="kod3-bit-select" style="float:left;width:90%;"></div></td>
                </tr>
            </table>
        </div>
        <div class="col-lg-1 col-sm-12 col-xs-12">
            <div class="btnListele" style="margin-top:15px;height:36px;text-align:center;background-color:#32c5d2;color:white;line-height:36px;">Listele</div>
        </div>
    </div>
    
</div>
<div class="row" style="margin-top:20px;">
    <div id="stok-raporu-grid"></div>
</div>
@section Scripts{<script src="~/Content/assets/global/plugins/moment/moment.min.js"></script>
<script>
    $(document).ready(function () {

        var model = @Html.Raw(Json.Encode(Model));
        var grupKod1="",grupKod2="ZZZZZZZZ",tipKod1="",tipKod2="ZZZZZZZZ",ozelKod1="",ozelKod2="ZZZZZZZZ",kod11="",kod12="ZZZZZZZZ",kod21="",kod22="ZZZZZZZZ",kod31="",kod32="ZZZZZZZZ",tarih;
        var grupKod = new Array();
        var tipKod = new Array();
        var ozelKod = new Array();
        var kod1 = new Array();
        var kod2 = new Array();
        var kod3 = new Array();
        jQuery.each( model, function( i, val ) {
            if(val.Tip==1){
                grupKod.push((model[i]));
            }
            else if(val.Tip==2){
                tipKod.push((model[i]));
            }
            else if(val.Tip==3){
                ozelKod.push((model[i]));
            }
            else if(val.Tip==4){
                kod1.push((model[i]));
            }
            else if(val.Tip==5){
                kod2.push((model[i]));
            }
            else if(val.Tip==6){
                kod3.push((model[i]));
            }
        });
        var dateVal = new Date();
        dateVal.setHours(0, 0, 0);
        var oaDate = Math.ceil((dateVal - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000));
        $(".btnListele").dxButton({
            onClick: function() {
                var Tarih = oaDate!="" ? oaDate: Math.ceil((dateVal - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000));
                PartialView("/Reports/Stock/StokList", 'stok-raporu-grid', JSON.stringify({ Tarih:Tarih, BasGrupKod:grupKod1, BitGrupKod:grupKod2, BasTipKod:tipKod1, BitTipKod:tipKod2, BasOzelKod:ozelKod1, BitOzelKod:ozelKod2, BasKod1:kod11, BitKod1:kod12, BasKod2:kod21, BitKod2:kod22, BasKod3:kod31, BitKod3:kod32 }));
            }
        });
        $(".tarih").dxDateBox({
            dataType: 'date',
            formatString: 'dd/MM/yyyy',
            value: dateVal,
            onValueChanged: function (e) {
                oaDate = Math.ceil((e.value - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000));
            }
        });
        $(".grup-bas-select").dxSelectBox({
            dataSource: grupKod,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                grupKod1=e.value;
            }
        });
        $(".grup-bit-select").dxSelectBox({
            dataSource: grupKod,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                grupKod2=e.value;
            }
        });
        $(".tip-bas-select").dxSelectBox({
            dataSource: tipKod,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                tipKod1=e.value;
            }
        });
        $(".tip-bit-select").dxSelectBox({
            dataSource: tipKod,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                tipKod2=e.value;
            }
        });
        $(".ozel-bas-select").dxSelectBox({
            dataSource: ozelKod,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                ozelKod1=e.value;
            }
        });
        $(".ozel-bit-select").dxSelectBox({
            dataSource: ozelKod,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                ozelKod2=e.value;
            }
        });
        $(".kod1-bas-select").dxSelectBox({
            dataSource: kod1,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                kod11=e.value;
            }
        });
        $(".kod1-bit-select").dxSelectBox({
            dataSource: kod1,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                kod12=e.value;
            }
        });
        $(".kod2-bas-select").dxSelectBox({
            dataSource: kod2,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                kod21=e.value;
            }
        });
        $(".kod2-bit-select").dxSelectBox({
            dataSource: kod2,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                kod22=e.value;
            }
        });
        $(".kod3-bas-select").dxSelectBox({
            dataSource: kod3,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                kod31=e.value;
            }
        });
        $(".kod3-bit-select").dxSelectBox({
            dataSource: kod3,
            valueExpr: 'Kod',
            displayExpr: 'Kod',
            onValueChanged: function (e) {
                kod32=e.value;
            }
        });
    });
</script>
}