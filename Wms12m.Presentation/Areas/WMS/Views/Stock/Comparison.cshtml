@{
    ViewBag.Title = "Stok Karşılaştırma";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="page-bar"><ul class="page-breadcrumb"><li><a href="/">Anasayfa</a><i class="fa fa-circle"></i></li><li><a href="/WMS/Stock">Stok</a><i class="fa fa-circle"></i></li><li><span>Karşılaştırma</span></li></ul></div>
    <h1 class="page-title">Stok Karşılaştırma</h1>
    <div class="row">
        <div class="col-md-12">
            <div>
                <div class="portlet box green">
                    <div class="portlet-title">
                        <div class="caption">
                            <i class="fa fa-gift"></i>Stok Karşılaştırma
                        </div>
                    </div>
                    <div class="portlet-body form">
                        <div class="form-horizontal">
                            <div class="form-body">
                                <div class="form-group">
                                    <div class="col-sm-3 control-label">Depo</div>
                                    <div class="col-sm-4">
                                        @Html.DropDownList("DepoID", null, htmlAttributes: new { @class = "form-control StoreListi input-circle" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-3 control-label">Başlangıç Mal Kodu</div>
                                    <div class="col-sm-4">
                                        <input class="form-control input-circle" id="BasMalKodu" name="BasMalKodu" placeholder="Başlangıç Mal Kodu" required="required" type="text" value="" aria-required="true">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-3 control-label">Bitiş Mal Kodu</div>
                                    <div class="col-sm-4">
                                        <input class="form-control input-circle" id="BitMalKodu" name="BitMalKodu" placeholder="Bitiş Mal Kodu" required="required" type="text" value="" aria-required="true">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-4 col-sm-offset-3">
                                        <button class="btn btn-default btn-block btn-circle" type="button" onclick="FuncSearchBtn()">Yenile <i class="icon-refresh"></i></button>
                                    </div>
                                </div>
                                <div id="GridComparison"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts{
        <script type="text/javascript">
        $("#DepoID").prepend("<option value=''>Seçiniz !!!</option>"); $("#DepoID")[0].selectedIndex = 0;
        var birim = "";
        function FuncSearchBtn() {
            if ($("#DepoID").val() == "") return;
            $('#GridComparison').html("");
            PartialView('/WMS/Stock/ComparisonList', 'GridComparison', JSON.stringify({ Id: $("#BasMalKodu").val() + "#" + $("#BitMalKodu").val() + "#" + $("#DepoID").val() }));
        }
        $("#BasMalKodu").autocomplete({
            source: "/WMS/Purchase/getMalzemebyCode/0",
            minLength: 2,
            select: function (event, ui) {
                getBirims(ui.item.id, 0);
            }
            });
            $("#BitMalKodu").autocomplete({
                source: "/WMS/Purchase/getMalzemebyCode/0",
                minLength: 2,
                select: function (event, ui) {
                    getBirims(ui.item.id, 1);
                }
            });

        function getBirims(id, tip) {
            $("#Birim option").remove();
            $.ajax({
                url: "/WMS/Purchase/getBirim",
                type: 'POST',
                data: JSON.stringify({ kod: id, s: 0 }),
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    birim = data[0].Birim1;
                    if (tip == 0)
                        $("#BasMalKodu").val(id);
                    else
                        $("#BitMalKodu").val(id);             
                }
            });
        }
        </script>
    }