@{
    ViewBag.Title = "Çek Onay";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="form-horizontal">
    <div class="form-body">
        <div class="portlet box green">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-gift"></i>Cek Onay GM
                </div>
                <div class="col-md-2 pull-right m-t-5">
                    <button class="btn btn-default pull-right input-circle yenile-buton"> Yenile </button>
                </div>
                <div class="col-md-2 pull-right m-t-5">
                    <a class="btn btn-default pull-right input-circle onay-buton" href="#modalEditPage" data-toggle="modal"> Onayla </a>
                </div>
                <div class="col-md-2 pull-right m-t-5">
                    <a class="btn btn-default pull-right input-circle reddet-buton" href="#modalEditPage" data-toggle="modal"> Reddet </a>
                </div>

            </div>
            <div class="portlet-body">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="col-md-12" style="width:100%;">
                            <div class="table-toolbar">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="btn-group">

                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="btn-group pull-right">
                                            <button class="btn green  btn-outline dropdown-toggle" data-toggle="dropdown">
                                                Tools
                                                <i class="fa fa-angle-down"></i>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li>
                                                    <a href="javascript:;">
                                                        <i class="fa fa-print"></i> Print
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;">
                                                        <i class="fa fa-file-pdf-o"></i> Save as PDF
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;">
                                                        <i class="fa fa-file-excel-o"></i> Export to Excel
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <table class="table table-striped table-bordered" id="sample_1">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>
                                                    <label class="mt-checkbox mt-checkbox-single mt-checkbox-outline">
                                                        <input type="checkbox" class="group-checkable" data-set="#sample_1 .checkboxes" />
                                                        <span></span>
                                                    </label>
                                                </th>
                                                <th> Evrak No </th>
                                                <th> Veren </th>
                                                <th> Ünvan </th>
                                                <th> Borçlu </th>
                                                <th> Borçlu Ünvan </th>
                                                <th> Vade Tarihi</th>
                                                <th> Tutar</th>
                                                <th> Bağlantı Tutar</th>
                                                <th> Bağlantının Ortalama Vadesi</th>
                                            </tr>
                                        </thead>
                                    </table>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>


    </div>
</div>
@section Scripts{
    <link href="~/Content/assets/global/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/Content/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" />
    <link href="~/Content/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" />
    <script src="~/Content/assets/global/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="~/Content/assets/global/scripts/datatable.js"></script>
    <script src="~/Content/assets/global/plugins/datatables/datatables.min.js"></script>
    <script src="~/Content/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js"></script>
    <script>

        var secili_satir = new Array();
        var secili_table = new Array();
        var table = $('#sample_1').DataTable({
            "language": { "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Turkish.json" },
            "ajax": {
                "url": '/Approvals/Check/GM_List',
                "dataSrc": function (json) {
                    return json;
                },
            },
            "fixedHeader": true,
            "columnDefs": [{ "visible": false, "targets": 0 }, { "type": "num-fmt", "className": "dt-right", "targets": [7, 8] }],
            "columns": [
                { "data": "ID" },
                { "data": null, "defaultContent": '', "className": 'select-checkbox', "orderable": false },
                { "data": "EvrakNo"},
                { "data": "Veren"},
                { "data": "Unvan"},
                { "data": "Borclu"},
                { "data": "BorcluUnvan"},
                { "data": "VadeTarihi"},
                { "data": "Tutar", "render": $.fn.dataTable.render.number('.', ',', 2, '')},
                { "data": "BaglantiTutar", "render": $.fn.dataTable.render.number('.', ',', 2, '')},
                { "data": "BaglantininOrtalamaVadesi", "render": function (data) { if (data != null) return formatDateFromJson(data); else return "&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;"; }, "sClass": "nowrap" },

            ],
            "ordering": false,
            "fnRowCallback": function (nRow, aData, iDisplayIndex) {
                $('td', nRow).attr('nowrap', 'nowrap');
                return nRow;
            }
        });

        $('#sample_1 tbody').on('click', 'tr', function () {
            $(this).toggleClass('selected');
        });
        $('.onay-buton').click(function () {

            var x = table.rows('.selected').data();
            for (var i = 0; i < x.length; i++) {
                secili_table.push(x[i]);
            }
            var _dfd = $.Deferred();
            $.ajax({
                url: window.location.origin + "/Approvals/Check/Onay_GM",
                data: { Data: JSON.stringify(secili_table) },
                type: "post",

                success: function (data) {
                    if (data.Status == true) {
                        Modaldialog(data.Message, "Güncelleme İşlemi", "Tamam", "Guncel");
                        setTimeout(function () { window.location.reload(); }, 500);
                    }
                    else {
                        if (data.Message == "") data.Message = "Hata oluştu";
                        Modaldialog(data.Message, "Hata", "Tamam", "btn-danger");
                        setTimeout(function () { window.location.reload(); }, 500);
                    }
                }
            });

            return _dfd.promise();
        });

        $('.reddet-buton').click(function () {

                var x = table.rows('.selected').data();
                for (var i = 0; i < x.length; i++) {
                    secili_table.push(x[i]);
                }
                var _dfd = $.Deferred();
                $.ajax({
                    url: window.location.origin + "/Approvals/Check/Red_GM",
                    data: { Data: JSON.stringify(secili_table) },
                    type: "post",
                    success: function (data) {
                        if (data.Status == true) {
                            Modaldialog(data.Message, "Güncelleme İşlemi", "Tamam", "Guncel");
                            setTimeout(function () { window.location.reload(); }, 500);
                        }
                        else {
                            if (data.Message == "") data.Message = "Hata oluştu";
                            Modaldialog(data.Message, "Hata", "Tamam", "btn-danger");
                            setTimeout(function () { window.location.reload(); }, 500);
                        }
                    }
                });
                return _dfd.promise();

        });

        $('.yenile-buton').click(function () {
           setTimeout(function () { window.location.reload(); }, 500);
        });
    </script>
}


@*@{
    ViewBag.Title = "Cek Onay";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="form-horizontal">
    <div class="form-body">
        <div class="portlet box green">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-gift"></i>Cek Onay GM
                </div>
                <div class="col-md-2 pull-right m-t-5">
                    <a class="btn btn-default pull-right input-circle yenile-buton" href="#modalEditPage" data-toggle="modal"> Yenile </a>
                </div>
                <div class="col-md-2 pull-right m-t-5">
                    <a class="btn btn-default pull-right input-circle onay-buton" href="#modalEditPage" data-toggle="modal"> Onayla </a>
                </div>
                <div class="col-md-2 pull-right m-t-5">
                    <a class="btn btn-default pull-right input-circle reddet-buton" href="#modalEditPage" data-toggle="modal"> Reddet </a>
                </div>

            </div>
            <div class="portlet-body">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="col-md-12" style="width:100%;">
                            <div class="table-toolbar">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="btn-group">

                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="btn-group pull-right">
                                            <button class="btn green  btn-outline dropdown-toggle" data-toggle="dropdown">
                                                Tools
                                                <i class="fa fa-angle-down"></i>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                                <li>
                                                    <a href="javascript:;">
                                                        <i class="fa fa-print"></i> Print
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;">
                                                        <i class="fa fa-file-pdf-o"></i> Save as PDF
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:;">
                                                        <i class="fa fa-file-excel-o"></i> Export to Excel
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <table class="table table-striped table-bordered table-hover" id="sample_1">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>
                                                    <label class="mt-checkbox mt-checkbox-single mt-checkbox-outline">
                                                        <input type="checkbox" class="group-checkable" data-set="#sample_1 .checkboxes" />
                                                        <span></span>
                                                    </label>
                                                </th>
                                                <th> Evrak No </th>
                                                <th> Veren </th>
                                                <th> Ünvan </th>
                                                <th> Borçlu </th>
                                                <th> Borçlu Ünvan </th>
                                                <th> Vade Tarihi</th>
                                                <th> Tutar</th>
                                                <th> Bağlantı Tutar</th>
                                                <th> Bağlantının Ortalama Vadesi</th>

                                            </tr>
                                        </thead>
                                    </table>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
</div>
@section Scripts{
    <link href="~/Content/assets/global/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/Content/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" />
    <link href="~/Content/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" />
    <script src="~/Content/assets/global/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="~/Content/assets/global/scripts/datatable.js"></script>
    <script src="~/Content/assets/global/plugins/datatables/datatables.min.js"></script>
    <script src="~/Content/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js"></script>
    <script>
        var secili_satir = new Array();
        var secili_table = new Array();
        var table = $('#sample_1').DataTable({
            "language": { "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Turkish.json" },
            "ajax": {
                "url": '/Approvals/Check/GMOnayCek',
                "dataSrc": function (json) {
                    return json;
                },
            },
            "fixedHeader": true,
            "columnDefs": [{ "visible": false, "targets": 0 }],
            "columns": [
                { "data": "ID" },
                { "data": null, "defaultContent": '', "className": 'select-checkbox', "orderable": false },
                { "data": "EvrakNo", "sClass": "nowrap" },
                { "data": "Veren", "sClass": "nowrap" },
                { "data": "Unvan", "sClass": "nowrap" },
                { "data": "Borclu", "sClass": "nowrap" },
                { "data": "BorcluUnvan", "sClass": "nowrap" },
                { "data": "VadeTarihi", "sClass": "nowrap" },
                { "data": "Tutar", "sClass": "nowrap" },
                { "data": "BaglantiTutar", "sClass": "nowrap" },
                { "data": "BaglantininOrtalamaVadesi", "render": function (data) { if (data != null) return formatDateFromJson(data); else return "&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;"; }, "sClass": "nowrap" },
            ],
            "ordering": false,
            "fnRowCallback": function (nRow, aData, iDisplayIndex) {
                $('td', nRow).attr('nowrap', 'nowrap');
                return nRow;
            }
        });


        $('#sample_1 tbody').on('click', 'tr', function () {
            $(this).toggleClass('selected');
        });


        $('.onay-buton').click(function () {
           
                var x = table.rows('.selected').data();
                for (var i = 0; i < x.length; i++) {
                    secili_table.push(x[i]);
                }
                var _dfd = $.Deferred();
                $.ajax({
                    url: window.location.origin + "/Approvals/Check/Onay_GM",
                    data: { Data: JSON.stringify(secili_table) },
                    type: "post",

                    success: function (data) {
                        if (data.Status == true) {
                            Modaldialog(data.Message, "Güncelleme İşlemi", "Tamam", "Guncel");
                        }
                        else {
                            if (data.Message == "") data.Message = "Hata oluştu";
                            Modaldialog(data.Message, "Hata", "Tamam", "btn-danger");
                        }
                    }
                });
                return _dfd.promise();
        });

        $('.reddet-buton').click(function () {
            
                var x = table.rows('.selected').data();
                for (var i = 0; i < x.length; i++) {
                    secili_table.push(x[i]);
                }
                var _dfd = $.Deferred();
                $.ajax({
                    url: window.location.origin + "/Approvals/Check/Red_GM",
                    data: { Data: JSON.stringify(secili_table) },
                    type: "post",
                    success: function (data) {
                        if (data.Status == true) {
                            Modaldialog(data.Message, "Güncelleme İşlemi", "Tamam", "Guncel");
                        }
                        else {
                            if (data.Message == "") data.Message = "Hata oluştu";
                            Modaldialog(data.Message, "Hata", "Tamam", "btn-danger");
                        }
                    }
                });
                return _dfd.promise();
        });

        $('.yenile-buton').click(function () {
           setTimeout(function () { window.location.reload(); }, 500);
        });
    </script>
}*@