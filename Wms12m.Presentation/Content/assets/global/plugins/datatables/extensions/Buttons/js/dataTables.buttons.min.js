/*! Buttons for DataTables 1.3.1
 * Â©2016 SpryMedia Ltd - datatables.net/license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var u=n.fn.dataTable,c=0,l=0,f=u.ext.buttons,e=function(t,i){typeof i=="undefined"&&(i={});i===!0&&(i={});n.isArray(i)&&(i={buttons:i});this.c=n.extend(!0,{},e.defaults,i);i.buttons&&(this.c.buttons=i.buttons);this.s={dt:new u.Api(t),buttons:[],listenKeys:"",namespace:"dtb"+c++};this.dom={container:n("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)};this._constructor()},o,s,h;n.extend(e.prototype,{action:function(n,t){var i=this._nodeToButton(n);return t===r?i.conf.action:(i.conf.action=t,this)},active:function(t,i){var e=this._nodeToButton(t),u=this.c.dom.button.active,f=n(e.node);return i===r?f.hasClass(u):(f.toggleClass(u,i===r?!0:i),this)},add:function(n,t){var f=this.s.buttons,i,r,u,e;if(typeof t=="string"){for(i=t.split("-"),r=this.s,u=0,e=i.length-1;u<e;u++)r=r.buttons[i[u]*1];f=r.buttons;t=i[i.length-1]*1}return this._expandButton(f,n,!1,t),this._draw(),this},container:function(){return this.dom.container},disable:function(t){var i=this._nodeToButton(t);return n(i.node).addClass(this.c.dom.button.disabled),this},destroy:function(){var u,t,i,r;for(n("body").off("keyup."+this.s.namespace),u=this.s.buttons.slice(),t=0,i=u.length;t<i;t++)this.remove(u[t].node);for(this.dom.container.remove(),r=this.s.dt.settings()[0],t=0,i=r.length;t<i;t++)if(r.inst===this){r.splice(t,1);break}return this},enable:function(t,i){if(i===!1)return this.disable(t);var r=this._nodeToButton(t);return n(r.node).removeClass(this.c.dom.button.disabled),this},name:function(){return this.c.name},node:function(t){var i=this._nodeToButton(t);return n(i.node)},processing:function(t,i){var u=this._nodeToButton(t);return i===r?n(u.node).hasClass("processing"):(n(u.node).toggleClass("processing",i),this)},remove:function(t){var i=this._nodeToButton(t),u=this._nodeToHost(t),f=this.s.dt,r,e;if(i.buttons.length)for(r=i.buttons.length-1;r>=0;r--)this.remove(i.buttons[r].node);return i.conf.destroy&&i.conf.destroy.call(f.button(t),f,n(t),i.conf),this._removeKey(i.conf),n(i.node).remove(),e=n.inArray(i,u),u.splice(e,1),this},text:function(t,i){var u=this._nodeToButton(t),f=this.c.dom.collection.buttonLiner,s=u.inCollection&&f&&f.tag?f.tag:this.c.dom.buttonLiner.tag,h=this.s.dt,e=n(u.node),o=function(n){return typeof n=="function"?n(h,e,u.conf):n};return i===r?o(u.conf.text):(u.conf.text=i,s?e.children(s).html(o(i)):e.html(o(i)),this)},_constructor:function(){var r=this,f=this.s.dt,u=f.settings()[0],e=this.c.buttons,t,o;for(u._buttons||(u._buttons=[]),u._buttons.push({inst:this,name:this.c.name}),t=0,o=e.length;t<o;t++)this.add(e[t]);f.on("destroy",function(){r.destroy()});n("body").on("keyup."+this.s.namespace,function(n){if(!i.activeElement||i.activeElement===i.body){var t=String.fromCharCode(n.keyCode).toLowerCase();r.s.listenKeys.toLowerCase().indexOf(t)!==-1&&r._keypress(t,n)}})},_addKey:function(t){t.key&&(this.s.listenKeys+=n.isPlainObject(t.key)?t.key.key:t.key)},_draw:function(n,t){n||(n=this.dom.container,t=this.s.buttons);n.children().detach();for(var i=0,r=t.length;i<r;i++)n.append(t[i].inserter),t[i].buttons&&t[i].buttons.length&&this._draw(t[i].collection,t[i].buttons)},_expandButton:function(t,i,u,f){for(var o,e,h,c=this.s.dt,a=0,l=n.isArray(i)?i:[i],s=0,v=l.length;s<v;s++)if(o=this._resolveExtends(l[s]),o){if(n.isArray(o)){this._expandButton(t,o,u,f);continue}(e=this._buildButton(o,u),e)&&(f!==r?(t.splice(f,0,e),f++):t.push(e),e.conf.buttons&&(h=this.c.dom.collection,e.collection=n("<"+h.tag+"/>").addClass(h.className).attr("role","menu"),e.conf._collection=e.collection,this._expandButton(e.buttons,e.conf.buttons,!0,f)),o.init&&o.init.call(c.button(e.node),c,n(e.node),o),a++)}},_buildButton:function(t,i){var u=this.c.dom.button,f=this.c.dom.buttonLiner,o=this.c.dom.collection,s=this.s.dt,h=function(n){return typeof n=="function"?n(s,r,t):n},c,r,a,e,v;return(i&&o.button&&(u=o.button),i&&o.buttonLiner&&(f=o.buttonLiner),t.available&&!t.available(s,t))?!1:(c=function(t,i,r,u){u.action.call(i.button(r),t,i,r,u);n(i.table().node()).triggerHandler("buttons-action.dt",[i.button(r),i,r,u])},r=n("<"+u.tag+"/>").addClass(u.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(n){n.preventDefault();!r.hasClass(u.disabled)&&t.action&&c(n,s,r,t);r.blur()}).on("keyup.dtb",function(n){n.keyCode===13&&!r.hasClass(u.disabled)&&t.action&&c(n,s,r,t)}),u.tag.toLowerCase()==="a"&&r.attr("href","#"),f.tag?(a=n("<"+f.tag+"/>").html(h(t.text)).addClass(f.className),f.tag.toLowerCase()==="a"&&a.attr("href","#"),r.append(a)):r.html(h(t.text)),t.enabled===!1&&r.addClass(u.disabled),t.className&&r.addClass(t.className),t.titleAttr&&r.attr("title",h(t.titleAttr)),t.namespace||(t.namespace=".dt-button-"+l++),e=this.c.dom.buttonContainer,v=e&&e.tag?n("<"+e.tag+"/>").addClass(e.className).append(r):r,this._addKey(t),{conf:t,node:r.get(0),inserter:v,buttons:[],inCollection:i,collection:null})},_nodeToButton:function(n,t){var i,u,r;for(t||(t=this.s.buttons),i=0,u=t.length;i<u;i++){if(t[i].node===n)return t[i];if(t[i].buttons.length&&(r=this._nodeToButton(n,t[i].buttons),r))return r}},_nodeToHost:function(n,t){var i,u,r;for(t||(t=this.s.buttons),i=0,u=t.length;i<u;i++){if(t[i].node===n)return t;if(t[i].buttons.length&&(r=this._nodeToHost(n,t[i].buttons),r))return r}},_keypress:function(t,i){var u=function(r,u){if(r.key)if(r.key===t)n(u).click();else if(n.isPlainObject(r.key)){if(r.key.key!==t)return;if(r.key.shiftKey&&!i.shiftKey)return;if(r.key.altKey&&!i.altKey)return;if(r.key.ctrlKey&&!i.ctrlKey)return;if(r.key.metaKey&&!i.metaKey)return;n(u).click()}},r=function(n){for(var t=0,i=n.length;t<i;t++)u(n[t].conf,n[t].node),n[t].buttons.length&&r(n[t].buttons)};r(this.s.buttons)},_removeKey:function(t){if(t.key){var r=n.isPlainObject(t.key)?t.key.key:t.key,i=this.s.listenKeys.split(""),u=n.inArray(r,i);i.splice(u,1);this.s.listenKeys=i.join("")}},_resolveExtends:function(t){var l=this.s.dt,i,e,c=function(i){for(var u=0;!n.isPlainObject(i)&&!n.isArray(i);){if(i===r)return;if(typeof i=="function"){if(i=i(l,t),!i)return!1}else if(typeof i=="string"){if(!f[i])throw"Unknown button type: "+i;i=f[i]}if(u++,u>30)throw"Buttons: Too many iterations";}return n.isArray(i)?i:n.extend({},i)},u,o,s,h;for(t=c(t);t&&t.extend;){if(!f[t.extend])throw"Cannot extend unknown button type: "+t.extend;if(u=c(f[t.extend]),n.isArray(u))return u;if(!u)return!1;if(o=u.className,t=n.extend({},u,t),o&&t.className!==o&&(t.className=o+" "+t.className),s=t.postfixButtons,s){for(t.buttons||(t.buttons=[]),i=0,e=s.length;i<e;i++)t.buttons.push(s[i]);t.postfixButtons=null}if(h=t.prefixButtons,h){for(t.buttons||(t.buttons=[]),i=0,e=h.length;i<e;i++)t.buttons.splice(i,0,h[i]);t.prefixButtons=null}t.extend=u.extend}return t}});e.background=function(t,i,u){u===r&&(u=400);t?n("<div/>").addClass(i).css("display","none").appendTo("body").fadeIn(u):n("body > div."+i).fadeOut(u,function(){n(this).removeClass(i).remove()})};e.instanceSelector=function(t,i){if(!t)return n.map(i,function(n){return n.inst});var r=[],f=n.map(i,function(n){return n.name}),u=function(t){var e,s,o;if(n.isArray(t)){for(e=0,s=t.length;e<s;e++)u(t[e]);return}typeof t=="string"?t.indexOf(",")!==-1?u(t.split(",")):(o=n.inArray(n.trim(t),f),o!==-1&&r.push(i[o].inst)):typeof t=="number"&&r.push(i[t].inst)};return u(t),r};e.buttonSelector=function(t,i){for(var s,u=[],o=function(n,t,i){for(var u,e,f=0,s=t.length;f<s;f++)u=t[f],u&&(e=i!==r?i+f:f+"",n.push({node:u.node,name:u.conf.name,idx:e}),u.buttons&&o(n,u.buttons,e+"-"))},f=function(t,i){var e,h,s=[],c,l,v,y,a;if(o(s,i.s.buttons),c=n.map(s,function(n){return n.node}),n.isArray(t)||t instanceof n){for(e=0,h=t.length;e<h;e++)f(t[e],i);return}if(t===null||t===r||t==="*")for(e=0,h=s.length;e<h;e++)u.push({inst:i,node:s[e].node});else if(typeof t=="number")u.push({inst:i,node:i.s.buttons[t].node});else if(typeof t=="string")if(t.indexOf(",")!==-1)for(l=t.split(","),e=0,h=l.length;e<h;e++)f(n.trim(l[e]),i);else if(t.match(/^\d+(\-\d+)*$/))v=n.map(s,function(n){return n.idx}),u.push({inst:i,node:s[n.inArray(t,v)].node});else if(t.indexOf(":name")!==-1)for(y=t.replace(":name",""),e=0,h=s.length;e<h;e++)s[e].name===y&&u.push({inst:i,node:s[e].node});else n(c).filter(t).each(function(){u.push({inst:i,node:this})});else typeof t=="object"&&t.nodeName&&(a=n.inArray(t,c),a!==-1&&u.push({inst:i,node:c[a]}))},e=0,h=t.length;e<h;e++)s=t[e],f(i,s);return u};e.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}};e.version="1.3.1";n.extend(f,{collection:{text:function(n){return n.i18n("buttons.collection","Collection")},className:"buttons-collection",action:function(i,r,u,f){var v=u,o=v.offset(),y=n(r.table().container()),s=!1,c,l,a,h;if(n("div.dt-button-background").length&&(s=n(".dt-button-collection").offset(),n("body").trigger("click.dtb-collection")),f._collection.addClass(f.collectionLayout).css("display","none").appendTo("body").fadeIn(f.fade),c=f._collection.css("position"),s&&c==="absolute"?f._collection.css({top:s.top,left:s.left}):c==="absolute"?(f._collection.css({top:o.top+v.outerHeight(),left:o.left}),l=o.left+f._collection.outerWidth(),a=y.offset().left+y.width(),l>a&&f._collection.css("left",o.left-(l-a))):(h=f._collection.height()/2,h>n(t).height()/2&&(h=n(t).height()/2),f._collection.css("marginTop",h*-1)),f.background&&e.background(!0,f.backgroundClassName,f.fade),setTimeout(function(){n("div.dt-button-background").on("click.dtb-collection",function(){});n("body").on("click.dtb-collection",function(t){var i=n.fn.addBack?"addBack":"andSelf";n(t.target).parents()[i]().filter(f._collection).length||(f._collection.fadeOut(f.fade,function(){f._collection.detach()}),n("div.dt-button-background").off("click.dtb-collection"),e.background(!1,f.backgroundClassName,f.fade),n("body").off("click.dtb-collection"),r.off("buttons-action.b-internal"))})},10),f.autoClose)r.on("buttons-action.b-internal",function(){n("div.dt-button-background").click()})},background:!0,collectionLayout:"",backgroundClassName:"dt-button-background",autoClose:!1,fade:400},copy:function(n,t){return f.copyHtml5?"copyHtml5":f.copyFlash&&f.copyFlash.available(n,t)?"copyFlash":void 0},csv:function(n,t){return f.csvHtml5&&f.csvHtml5.available(n,t)?"csvHtml5":f.csvFlash&&f.csvFlash.available(n,t)?"csvFlash":void 0},excel:function(n,t){return f.excelHtml5&&f.excelHtml5.available(n,t)?"excelHtml5":f.excelFlash&&f.excelFlash.available(n,t)?"excelFlash":void 0},pdf:function(n,t){return f.pdfHtml5&&f.pdfHtml5.available(n,t)?"pdfHtml5":f.pdfFlash&&f.pdfFlash.available(n,t)?"pdfFlash":void 0},pageLength:function(t){var i=t.settings()[0].aLengthMenu,u=n.isArray(i[0])?i[0]:i,f=n.isArray(i[0])?i[1]:i,r=function(n){return n.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},n.page.len())};return{extend:"collection",text:r,className:"buttons-page-length",autoClose:!0,buttons:n.map(u,function(n,t){return{text:f[t],className:"button-page-length",action:function(t,i){i.page.len(n).draw()},init:function(t,i,r){var f=this,u=function(){f.active(t.page.len()===n)};t.on("length.dt"+r.namespace,u);u()},destroy:function(n,t,i){n.off("length.dt"+i.namespace)}}}),init:function(n,t,i){var u=this;n.on("length.dt"+i.namespace,function(){u.text(r(n))})},destroy:function(n,t,i){n.off("length.dt"+i.namespace)}}}});u.Api.register("buttons()",function(n,t){t===r&&(t=n,n=r);this.selector.buttonGroup=n;var i=this.iterator(!0,"table",function(i){if(i._buttons)return e.buttonSelector(e.instanceSelector(n,i._buttons),t)},!0);return i._groupSelector=n,i});u.Api.register("button()",function(n,t){var i=this.buttons(n,t);return i.length>1&&i.splice(1,i.length),i});u.Api.registerPlural("buttons().active()","button().active()",function(n){return n===r?this.map(function(n){return n.inst.active(n.node)}):this.each(function(t){t.inst.active(t.node,n)})});u.Api.registerPlural("buttons().action()","button().action()",function(n){return n===r?this.map(function(n){return n.inst.action(n.node)}):this.each(function(t){t.inst.action(t.node,n)})});u.Api.register(["buttons().enable()","button().enable()"],function(n){return this.each(function(t){t.inst.enable(t.node,n)})});u.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(n){n.inst.disable(n.node)})});u.Api.registerPlural("buttons().nodes()","button().node()",function(){var t=n();return n(this.each(function(n){t=t.add(n.inst.node(n.node))})),t});u.Api.registerPlural("buttons().processing()","button().processing()",function(n){return n===r?this.map(function(n){return n.inst.processing(n.node)}):this.each(function(){})});u.Api.registerPlural("buttons().text()","button().text()",function(n){return n===r?this.map(function(n){return n.inst.text(n.node)}):this.each(function(t){t.inst.text(t.node,n)})});u.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(n){n.inst.node(n.node).trigger("click")})});u.Api.registerPlural("buttons().containers()","buttons().container()",function(){var t=n(),i=this._groupSelector;return this.iterator(!0,"table",function(n){var u,r,f;if(n._buttons)for(u=e.instanceSelector(i,n._buttons),r=0,f=u.length;r<f;r++)t=t.add(u[r].container())}),t});u.Api.register("button().add()",function(n,t){var r=this.context,i;return r.length&&(i=e.instanceSelector(this._groupSelector,r[0]._buttons),i.length&&i[0].add(t,n)),this.button(this._groupSelector,n)});u.Api.register("buttons().destroy()",function(){return this.pluck("inst").unique().each(function(n){n.destroy()}),this});u.Api.registerPlural("buttons().remove()","buttons().remove()",function(){return this.each(function(n){n.inst.remove(n.node)}),this});u.Api.register("buttons.info()",function(t,i,u){var f=this;return t===!1?(n("#datatables_buttons_info").fadeOut(function(){n(this).remove()}),clearTimeout(o),o=null,this):(o&&clearTimeout(o),n("#datatables_buttons_info").length&&n("#datatables_buttons_info").remove(),t=t?"<h2>"+t+"<\/h2>":"",n('<div id="datatables_buttons_info" class="dt-button-info"/>').html(t).append(n("<div/>")[typeof i=="string"?"html":"append"](i)).css("display","none").appendTo("body").fadeIn(),u!==r&&u!==0&&(o=setTimeout(function(){f.buttons.info(!1)},u)),this)});u.Api.register("buttons.exportData()",function(n){if(this.context.length)return h(new u.Api(this.context[0]),n)});s=n("<textarea/>")[0];h=function(t,i){for(var c,u,r=n.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(n){return o(n)},footer:function(n){return o(n)},body:function(n){return o(n)}}},i),o=function(n){return typeof n!="string"?n:(n=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),r.stripHtml&&(n=n.replace(/<[^>]*>/g,"")),r.trim&&(n=n.replace(/^\s+|\s+$/g,"")),r.stripNewlines&&(n=n.replace(/\n/g," ")),r.decodeEntities&&(s.innerHTML=n,n=s.value),n)},l=t.columns(r.columns).indexes().map(function(n){var i=t.column(n).header();return r.format.header(i.innerHTML,n,i)}).toArray(),w=t.table().footer()?t.columns(r.columns).indexes().map(function(n){var i=t.column(n).footer();return r.format.footer(i?i.innerHTML:"",n,i)}).toArray():null,b=t.rows(r.rows,r.modifier).indexes().toArray(),a=t.cells(b,r.columns),v=a.render(r.orthogonal).toArray(),k=a.nodes().toArray(),f=l.length,y=f>0?v.length/f:0,p=new Array(y),h=0,e=0,d=y;e<d;e++){for(c=new Array(f),u=0;u<f;u++)c[u]=r.format.body(v[h],e,u,k[h]),h++;p[e]=c}return{header:l,footer:w,body:p}};n.fn.dataTable.Buttons=e;n.fn.DataTable.Buttons=e;n(i).on("init.dt plugin-init.dt",function(n,t){if(n.namespace==="dt"){var i=t.oInit.buttons||u.defaults.buttons;i&&!t._buttons&&new e(t,i).container()}});return u.ext.feature.push({fnInit:function(n){var t=new u.Api(n),i=t.init().buttons||u.defaults.buttons;return new e(t,i).container()},cFeature:"B"}),e});